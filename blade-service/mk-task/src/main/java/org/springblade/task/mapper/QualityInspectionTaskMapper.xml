<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.springblade.task.mapper.QualityInspectionTaskMapper">

    <select id="completeCount" resultType="int">
        SELECT COUNT(*) FROM
        <if test="param1!= null and param1!= '' and param1 == 'dev'">
            bladex_dev.mk_task_quality_inspection t
            left join bladex_flow_dev.ACT_HI_PROCINST flow
        </if>
        <if test="param1!= null and param1!= '' and param1 == 'prod'">
            bladex.mk_task_quality_inspection t
            left join bladex_flow.ACT_HI_PROCINST flow
        </if>
        ON t.process_instance_id = flow.PROC_INST_ID_
        WHERE t.inspection_task_id = #{param2} AND flow.END_ACT_ID_ = #{param3}
    </select>

</mapper>
